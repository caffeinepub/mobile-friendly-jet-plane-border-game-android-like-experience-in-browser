{
  "kind": "build_request",
  "title": "Fix obstacle visibility at time end and show 'Time up!' message",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-6",
      "text": "Ensure regular obstacles and boss obstacles remain visible (do not disappear unexpectedly) when the level timer reaches 0 and the game transitions out of the 'playing' state (e.g., into 'exploding' and then 'gameover').",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "obstacles and boss obstacles invisible. when time is over. it should display time up!"
        ]
      },
      "acceptanceCriteria": [
        "When the countdown reaches 0, any obstacles (including the boss) that were on-screen remain rendered on the playfield during the 'exploding' transition and until the game over UI fully takes over.",
        "Boss obstacle remains rendered with its boss styling (red scheme) through the time-expired transition.",
        "Reproduction check: start a level, allow timer to expire without dying to border/obstacle, and confirm obstacles do not flicker/disappear due to state transition."
      ]
    },
    {
      "id": "REQ-7",
      "text": "Add a distinct 'time expired' game-over reason and display a clear 'TIME UP!' message when the countdown reaches 0 (different from other loss conditions such as hitting the border).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "when time is over. it should display time up!"
        ]
      },
      "acceptanceCriteria": [
        "If the timer reaches 0, the game over overlay shows the text \"TIME UP!\" (English, user-facing).",
        "If the game ends for other existing reasons (e.g., player hits the border), the game over overlay does not show \"TIME UP!\" and continues to show the normal game-over messaging.",
        "The 'TIME UP!' message is visible and legible above any background/blur effects on the game over overlay."
      ]
    }
  ],
  "constraints": [
    "Do not edit files under frontend/src/components/ui (compose existing UI components instead).",
    "Do not modify immutable hook entrypoints (frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx)."
  ],
  "nonGoals": [
    "Adding new backend persistence, leaderboards, or user accounts beyond existing Internet Identity scaffolding.",
    "Changing overall level timing rules (e.g., getLevelDuration) beyond what is needed to correctly detect and present time-expired state."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}